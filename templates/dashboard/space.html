{% extends 'base.html' %}
{% block head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
<style>
  body { background: #f7f7fa; }
  .sidebar { min-width: 220px; background: #222; color: #fff; height: 100vh; position: fixed; display: flex; flex-direction: column; }
  .sidebar a { color: #fff; display: block; padding: 1em; text-decoration: none; }
  .sidebar a.active, .sidebar a:hover { background: #007bff; }
  .main { margin-left: 220px; padding: 2em; }
  .table thead { background: #eee; }
  @media (max-width: 800px) {
    .sidebar { position: static; width: 100%; height: auto; min-width: 0; }
    .main { margin-left: 0; padding: 1em; }
  }
</style>
{% endblock %}
{% block content %}
<div class="sidebar">
  <h4 class="p-3">Admin</h4>
  <a href="#" class="active" data-category="hotel">Réservations Hôtels</a>
  <a href="#" data-category="location">Location Véhicules</a>
  <a href="#" data-category="conciergerie">Conciergerie</a>
  <a href="#" data-category="tdg">Traduction/Guide</a>
  <a href="#" data-category="aeroport">Aéroport</a>
  <a href="#" data-category="visa">Visa/Carte</a>
  <div class="mt-auto border-top border-secondary">
    <a href="/app/account/logout/" class="d-block" title="Se déconnecter">
      <i class="bi bi-box-arrow-right me-2"></i> Se déconnecter
    </a>
  </div>
</div>
<div class="main">
  <div id="table-hotel" class="admin-table">
    <h2>Réservations Hôtels</h2>
    <table class="table table-bordered table-hover">
      <thead>
        <tr>
          <th>#</th>
          <th>Ville</th>
          <th>Date arrivée</th>
          <th>Date départ</th>
          <th>Hébergement</th>
          <th>Chambre</th>
          <th>Budget</th>
          <th>Contact</th>
          <th>Date soumission</th>
          <th>Détails</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td>Kinshasa</td>
          <td>2025-09-01</td>
          <td>2025-09-10</td>
          <td>Hôtel 4 étoiles</td>
          <td>Suite</td>
          <td>100–200 USD</td>
          <td>Jean Dupont<br>jean@email.com<br>+243 900 000 000</td>
          <td>2025-08-14 10:23</td>
          <td><a href="#" class="voir-detail" data-type="hotel" data-ville="Kinshasa" data-date-arrivee="2025-09-01" data-date-depart="2025-09-10" data-hebergement="Hôtel 4 étoiles" data-chambre="Suite" data-budget="100–200 USD" data-nom="Jean Dupont" data-contact="Jean Dupont<br>jean@email.com<br>+243 900 000 000" data-soumission="2025-08-14 10:23">Voir</a></td>
        </tr>
      </tbody>
    </table>
    <div class="modal fade" id="reservationDetailModal" tabindex="-1" aria-labelledby="reservationDetailModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg">
          <div class="modal-header bg-primary text-white border-0">
            <div class="d-flex align-items-center">
              <span id="modal-icon" class="me-2" style="font-size:2rem;"></span>
              <h5 class="modal-title mb-0" id="reservationDetailModalLabel">Détail</h5>
            </div>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body p-4">
            <div id="modal-detail-content"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="table-location" class="admin-table" style="display:none;">
    <h2>Location Véhicules</h2>
    <table class="table table-bordered table-hover">
      <thead>
        <tr>
          <th>#</th><th>Ville</th><th>Date début</th><th>Heure</th><th>Durée</th><th>Type</th><th>Contact</th><th>Date soumission</th><th>Détails</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>1</td><td>Goma</td><td>2025-08-20</td><td>09:00</td><td>2-3 jours</td><td>SUV</td><td>Marie K.<br>marie@email.com</td><td>2025-08-14 11:00</td><td><a href="#" class="voir-detail" data-type="location" data-ville="Goma" data-date-debut="2025-08-20" data-heure="09:00" data-duree="2-3 jours" data-type-vehicule="SUV" data-nom="Marie K." data-contact="Marie K.<br>marie@email.com" data-soumission="2025-08-14 11:00">Voir</a></td></tr>
      </tbody>
    </table>
  </div>
  <div id="table-conciergerie" class="admin-table" style="display:none;">
    <h2>Conciergerie</h2>
    <table class="table table-bordered table-hover">
      <thead>
        <tr><th>#</th><th>Nature</th><th>Urgence</th><th>Contact</th><th>Date soumission</th><th>Détails</th></tr>
      </thead>
      <tbody>
        <tr><td>1</td><td>Réservation restaurant</td><td>Immédiat</td><td>Paul B.<br>paul@email.com</td><td>2025-08-14 12:00</td><td><a href="#" class="voir-detail" data-type="conciergerie" data-nature="Réservation restaurant" data-urgence="Immédiat" data-nom="Paul B." data-contact="Paul B.<br>paul@email.com" data-soumission="2025-08-14 12:00">Voir</a></td></tr>
      </tbody>
    </table>
  </div>
  <div id="table-tdg" class="admin-table" style="display:none;">
    <h2>Traduction/Guide</h2>
    <table class="table table-bordered table-hover">
      <thead>
        <tr><th>#</th><th>Service</th><th>Nom</th><th>Email</th><th>Date soumission</th><th>Détails</th></tr>
      </thead>
      <tbody>
        <tr><td>1</td><td>Traduction</td><td>Ali S.</td><td>ali@email.com</td><td>2025-08-14 13:00</td><td><a href="#" class="voir-detail" data-type="tdg" data-service="Traduction" data-nom="Ali S." data-email="ali@email.com" data-soumission="2025-08-14 13:00">Voir</a></td></tr>
      </tbody>
    </table>
  </div>
  <div id="table-aeroport" class="admin-table" style="display:none;">
    <h2>Aéroport</h2>
    <table class="table table-bordered table-hover">
      <thead>
        <tr><th>#</th><th>Aéroport</th><th>Type</th><th>Date</th><th>Contact</th><th>Date soumission</th><th>Détails</th></tr>
      </thead>
      <tbody>
        <tr><td>1</td><td>Kinshasa</td><td>Arrivée</td><td>2025-08-21</td><td>Sarah L.<br>sarah@email.com</td><td>2025-08-14 14:00</td><td><a href="#" class="voir-detail" data-type="aeroport" data-aeroport="Kinshasa" data-type-vol="Arrivée" data-date="2025-08-21" data-nom="Sarah L." data-contact="Sarah L.<br>sarah@email.com" data-soumission="2025-08-14 14:00">Voir</a></td></tr>
      </tbody>
    </table>
  </div>
  <div id="table-visa" class="admin-table" style="display:none;">
    <h2>Visa/Carte de Travail</h2>
    <table class="table table-bordered table-hover">
      <thead>
        <tr><th>#</th><th>Type</th><th>Nom</th><th>Email</th><th>Date soumission</th><th>Détails</th></tr>
      </thead>
      <tbody>
        <tr><td>1</td><td>Visa Volant</td><td>Omar D.</td><td>omar@email.com</td><td>2025-08-14 15:00</td><td><a href="#" class="voir-detail" data-type="visa" data-type-visa="Visa Volant" data-nom="Omar D." data-email="omar@email.com" data-soumission="2025-08-14 15:00">Voir</a></td></tr>
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  const links = document.querySelectorAll('.sidebar a[data-category]');
  const tables = document.querySelectorAll('.admin-table');
  links.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      links.forEach(l => l.classList.remove('active'));
      this.classList.add('active');
      tables.forEach(t => t.style.display = 'none');
      const cat = this.getAttribute('data-category');
      document.getElementById('table-' + cat).style.display = '';
    });
  });

  const icons = {
    hotel: '<i class="bi bi-building"></i>',
    location: '<i class="bi bi-car-front"></i>',
    conciergerie: '<i class="bi bi-bell"></i>',
    tdg: '<i class="bi bi-translate"></i>',
    aeroport: '<i class="bi bi-airplane"></i>',
    visa: '<i class="bi bi-file-earmark-person"></i>'
  };

  document.addEventListener('click', function(e) {
    const link = e.target.closest('.voir-detail');
    if (!link) return;
    e.preventDefault();
    const type = link.getAttribute('data-type');
    let html = '';
    let title = '';
    let icon = icons[type] || '';
    let nom = link.getAttribute('data-nom');
    if(type === 'hotel') {
      title = 'Détail Réservation Hôtel';
      html = `
        ${nom ? `<div class='row mb-2'><div class='col-5 fw-bold'>Nom:</div><div class='col-7'>${nom}</div></div>` : ''}
        <div class="row mb-2"><div class="col-5 fw-bold">Ville:</div><div class="col-7">${link.getAttribute('data-ville')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Date arrivée:</div><div class="col-7">${link.getAttribute('data-date-arrivee')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Date départ:</div><div class="col-7">${link.getAttribute('data-date-depart')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Hébergement:</div><div class="col-7">${link.getAttribute('data-hebergement')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Chambre:</div><div class="col-7">${link.getAttribute('data-chambre')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Budget:</div><div class="col-7">${link.getAttribute('data-budget')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Contact:</div><div class="col-7">${link.getAttribute('data-contact')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Date soumission:</div><div class="col-7">${link.getAttribute('data-soumission')}</div></div>
      `;
    } else if(type === 'location') {
      title = 'Détail Location Véhicule';
      html = `
        ${nom ? `<div class='row mb-2'><div class='col-5 fw-bold'>Nom:</div><div class='col-7'>${nom}</div></div>` : ''}
        <div class="row mb-2"><div class="col-5 fw-bold">Ville:</div><div class="col-7">${link.getAttribute('data-ville')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Date début:</div><div class="col-7">${link.getAttribute('data-date-debut')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Heure:</div><div class="col-7">${link.getAttribute('data-heure')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Durée:</div><div class="col-7">${link.getAttribute('data-duree')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Type:</div><div class="col-7">${link.getAttribute('data-type-vehicule')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Contact:</div><div class="col-7">${link.getAttribute('data-contact')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Date soumission:</div><div class="col-7">${link.getAttribute('data-soumission')}</div></div>
      `;
    } else if(type === 'conciergerie') {
      title = 'Détail Conciergerie';
      html = `
        ${nom ? `<div class='row mb-2'><div class='col-5 fw-bold'>Nom:</div><div class='col-7'>${nom}</div></div>` : ''}
        <div class="row mb-2"><div class="col-5 fw-bold">Nature:</div><div class="col-7">${link.getAttribute('data-nature')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Urgence:</div><div class="col-7">${link.getAttribute('data-urgence')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Contact:</div><div class="col-7">${link.getAttribute('data-contact')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Date soumission:</div><div class="col-7">${link.getAttribute('data-soumission')}</div></div>
      `;
    } else if(type === 'tdg') {
      title = 'Détail Traduction/Guide';
      html = `
        ${nom ? `<div class='row mb-2'><div class='col-5 fw-bold'>Nom:</div><div class='col-7'>${nom}</div></div>` : ''}
        <div class="row mb-2"><div class="col-5 fw-bold">Service:</div><div class="col-7">${link.getAttribute('data-service')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Email:</div><div class="col-7">${link.getAttribute('data-email')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Date soumission:</div><div class="col-7">${link.getAttribute('data-soumission')}</div></div>
      `;
    } else if(type === 'aeroport') {
      title = 'Détail Accompagnement Aéroport';
      html = `
        ${nom ? `<div class='row mb-2'><div class='col-5 fw-bold'>Nom:</div><div class='col-7'>${nom}</div></div>` : ''}
        <div class="row mb-2"><div class="col-5 fw-bold">Aéroport:</div><div class="col-7">${link.getAttribute('data-aeroport')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Type:</div><div class="col-7">${link.getAttribute('data-type-vol')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Date:</div><div class="col-7">${link.getAttribute('data-date')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Contact:</div><div class="col-7">${link.getAttribute('data-contact')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Date soumission:</div><div class="col-7">${link.getAttribute('data-soumission')}</div></div>
      `;
    } else if(type === 'visa') {
      title = 'Détail Visa/Carte de Travail';
      html = `
        ${nom ? `<div class='row mb-2'><div class='col-5 fw-bold'>Nom:</div><div class='col-7'>${nom}</div></div>` : ''}
        <div class="row mb-2"><div class="col-5 fw-bold">Type:</div><div class="col-7">${link.getAttribute('data-type-visa')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Email:</div><div class="col-7">${link.getAttribute('data-email')}</div></div>
        <div class="row mb-2"><div class="col-5 fw-bold">Date soumission:</div><div class="col-7">${link.getAttribute('data-soumission')}</div></div>
      `;
    }
    document.getElementById('reservationDetailModalLabel').textContent = title;
    document.getElementById('modal-icon').innerHTML = icon;
    document.getElementById('modal-detail-content').innerHTML = html;
    var modal = new bootstrap.Modal(document.getElementById('reservationDetailModal'));
    modal.show();
  });
});
</script>
{% endblock %}
